var config = require('helmet-csp/lib/config')
var checkers = {
  sourceList: require('helmet-csp/lib/check-options/check-directive/source-list'),
  pluginTypes: require('helmet-csp/lib/check-options/check-directive/plugin-types'),
  sandbox: require('helmet-csp/lib/check-options/check-directive/sandbox'),
  reportUri: require('helmet-csp/lib/check-options/check-directive/report-uri'),
  requireSriFor: require('helmet-csp/lib/check-options/check-directive/require-sri-for'),
  boolean: require('helmet-csp/lib/check-options/check-directive/boolean')
}

module.exports = function (key, value, options) {
  if (options.loose) { return }

  if (!config.directives.hasOwnProperty(key)) {
    throw new Error('"' + key + '" is an invalid directive. See the documentation for the supported list. Force this by enabling loose mode.')
  }

  var directiveType = config.directives[key].type
  checkers[directiveType](key, value, options)
}
